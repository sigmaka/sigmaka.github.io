
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Frequenzanalyse &#8212; ABBTS MAT_AGW</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '06_FFT/01_FFT';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Unterrichtsbeispiel" href="02_FFT_Unterricht.html" />
    <link rel="prev" title="Übungen" href="../05_SCIPY/11_SCIPY_Uebungen.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../00_INTRO.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="ABBTS MAT_AGW - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="ABBTS MAT_AGW - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../00_INTRO.html">
                    Modulübersicht
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../01_NUMPY/01_NUMPY.html">Arrays</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../01_NUMPY/02_NUMPY_Unterricht.html">Unterrichtsbeispiel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01_NUMPY/11_NUMPY_Uebungen.html">Übungen</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../02_MATPLOTLIB/01_MATPLOTLIB.html">Plotting/Visualisierung</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../02_MATPLOTLIB/02_MATPLOTLIB_Unterricht.html">Unterrichtsbeispiel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_MATPLOTLIB/11_MATPLOTLIB_Uebungen.html">Übungen</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../03_VEKTORRECHNUNG/01_VEKTORRECHNUNG.html">Vektorrechnung</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../03_VEKTORRECHNUNG/02_VEKTORRECHNUNG_Unterricht.html">Unterrichtsbeispiel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_VEKTORRECHNUNG/11_VEKTORRECHNUNG_Uebungen.html">Übungen</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04_DATENAUSWERTUNG/01_DATENAUSWERTUNG.html">Datenauswertung</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_DATENAUSWERTUNG/02_DATENAUSWERTUNG_Unterricht.html">Unterrichtsbeispiel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_DATENAUSWERTUNG/11_DATENAUSWERTUNG_Uebungen.html">Übungen</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../05_SCIPY/01_SCIPY.html">Signalverarbeitung</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../05_SCIPY/02_SCIPY_Unterricht.html">Unterrichtsbeispiel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_SCIPY/11_SCIPY_Uebungen.html">Übungen</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">Frequenzanalyse</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="02_FFT_Unterricht.html">Unterrichtsbeispiel</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_FFT_Workflow.html">Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_FFT_Uebungen.html">Übungen</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/sigmaka/MAT_AGW" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/sigmaka/MAT_AGW/issues/new?title=Issue%20on%20page%20%2F06_FFT/01_FFT.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/06_FFT/01_FFT.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Frequenzanalyse</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#blockinhalt">Blockinhalt</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#voraussetzungen">Voraussetzungen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">1. Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grundlagen">2. Grundlagen</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fourierreihe">2.1 Fourierreihe</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fouriereihe-in-sinus-kosinus-form">Fouriereihe in Sinus-Kosinus-Form</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fouriereihe-in-amplituden-phasen-form">Fouriereihe in Amplituden-Phasen-Form</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fouriereihe-in-exponentialform">Fouriereihe in Exponentialform</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diskrete-fouriertransformation-dft">2.2 Diskrete Fouriertransformation (DFT)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fft-algorithmus">2.3 FFT-Algorithmus</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy-implementierung-scipy-fft">2.3.1 SciPy-Implementierung (<code class="docutils literal notranslate"><span class="pre">scipy.fft</span></code>)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#praktische-umsetzung">3. Praktische Umsetzung</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequenzauflosung-und-maximale-frequenz">3.1 Frequenzauflösung und maximale Frequenz</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#periodizitat-bzw-fensterfunktionen">3.2 Periodizität bzw. Fensterfunktionen</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampleanzahl">3.3 Sampleanzahl</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtasttheorem">3.4 Abtasttheorem</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="frequenzanalyse">
<h1>Frequenzanalyse<a class="headerlink" href="#frequenzanalyse" title="Link to this heading">#</a></h1>
<p><img src="../01_NUMPY/img/logo.png" width="100%"/><br>
<a class="reference internal" href="../00_INTRO.html"><span class="std std-doc">← Modulübersicht</span></a></p>
<center>
    <img src="img/fft.svg" width=100%/>
</center>
<p>Die Frequenzanalyse ist ein sehr wichtiges Werkzeug in der Signalverarbeitung/Messtechnik, mit dem untersucht werden kann, welche <strong>Frequenzanteile</strong> wie stark in einem Signal vertreten sind. Die <strong>Fouriertransformation</strong> bildet dabei das Kernstück. Diese werden wir im Folgenden schrittweise kennenlernen, wobei zum einen das theoretische Hintergrundwissen und zum andern die praktische Anwendung relevant sein werden. Für die Umsetzung in Python werden wir das Paket <a class="reference internal" href="../05_SCIPY/01_SCIPY.html"><span class="std std-doc">SciPy</span></a> verwenden, welches bereits bekannt ist.</p>
<hr class="docutils" />
<section id="blockinhalt">
<h2>Blockinhalt<a class="headerlink" href="#blockinhalt" title="Link to this heading">#</a></h2>
<p>Für die Einführung in die Frequenzanalyse/Fouriertransformation bzw. die selbstständige Einarbeitung stehen die folgenden Notebooks bereit:</p>
<ol class="arabic simple">
<li><p>Einführung/Theorie/Cheat Sheet (vorliegendes Notebook)</p></li>
<li><p>Beispielaufgabe im Unterricht <a class="reference internal" href="02_FFT_Unterricht.html"><span class="std std-doc">02_FFT_Unterricht.ipynb</span></a></p></li>
<li><p>Übersicht FFT-Workflow <a class="reference internal" href="03_FFT_Workflow.html"><span class="std std-doc">03_FFT_Workflow.ipynb</span></a></p></li>
<li><p>Übungsaufgaben <a class="reference internal" href="11_FFT_Uebungen.html"><span class="std std-doc">11_FFT_Uebungen.ipynb</span></a></p></li>
</ol>
</section>
<hr class="docutils" />
<section id="voraussetzungen">
<h2>Voraussetzungen<a class="headerlink" href="#voraussetzungen" title="Link to this heading">#</a></h2>
<p>Wir werden die theoretischen Grundlagen der Fourierreihe bzw. -tranformation relativ zügig durchgehen, da die praktische Umsetzung im Vordergrund steht. Da Kosinus- bzw. Sinusschwingungen die Grundlage der Fouriertransformation darstellen, wird die Darstellung einer Kosinus- bzw. Sinusschwingung im Zeitbereich, z. B. in der Form <span class="math notranslate nohighlight">\(y(t) = \hat y\cdot\cos(\omega t + \varphi)\)</span> bzw. <span class="math notranslate nohighlight">\(y(t) = \hat y\cdot\sin(\omega t + \varphi)\)</span> als bekannt vorausgesetzt. Die Begriffe <em>Amplitude</em>, <em>Frequenz</em> bzw. <em>Kreisfrequenz</em> sowie <em>Phasenverschiebung</em> sollten klar sein.</p>
<center>
    <img src="img/Sine.svg" />
</center>
<p>Sie sollten sich im Klaren sein, dass sich die Sinus- und die Kosinusfunktion nur durch eine Phasenverschiebung unterscheiden. Im Weiteren sollte bekannt sein, dass im Zusammenhang mit Schwingungen die Kreisfrequenz <span class="math notranslate nohighlight">\(\omega\)</span> [rad/s] alternativ zur “normalen” Frequenz <span class="math notranslate nohighlight">\(f\)</span> [Hz] verwendet werden kann und die beiden folgendermassen zusammenhängen:</p>
<div class="math notranslate nohighlight">
\[\omega = 2 \pi f\]</div>
</section>
<hr class="docutils" />
<section id="motivation">
<h2>1. Motivation<a class="headerlink" href="#motivation" title="Link to this heading">#</a></h2>
<p>In vielen technischen Problemstellungen treten Signale auf, welche unterschiedliche Frequenzanteile enthalten und bei der Analyse geht es u. a. um die Frage, welche Frequenzanteile wie stark ausgeprägt sind (Frequenzanalyse, auch Fourieranalyse oder harmonische Analyse genannt). In der Technik ist die Frequenzanalyse in unzähligen Gebieten anzutreffen, wobei für uns die <em>Messtechnik</em> im Vordergrund steht.</p>
<ul class="simple">
<li><p>Messtechnik (Schwingungen, akustische bzw. optische/bildgebende Verfahren)</p></li>
<li><p>Datenkompression (Ton, Bild, Video etc.)</p></li>
<li><p>Signalverarbeitung (Filterung, …)</p></li>
<li><p>Mathematik/Physik (Lösen von bestimmten Problemen)</p></li>
<li><p>…</p></li>
</ul>
</section>
<section id="grundlagen">
<h2>2. Grundlagen<a class="headerlink" href="#grundlagen" title="Link to this heading">#</a></h2>
<section id="fourierreihe">
<h3>2.1 Fourierreihe<a class="headerlink" href="#fourierreihe" title="Link to this heading">#</a></h3>
<p>Gemäss <em>Fourier</em> kann jede beliebige periodische Funktion <span class="math notranslate nohighlight">\(y(t)\)</span>, im Folgenden Signal oder Zeitsignal genannt, als Summe von unendlich vielen Sinus- und Kosinusschwingungen repräsentiert werden (Fourierreihe). Wie wir später sehen werden, besteht das Ziel der Fouriertransformation im Wesentlichen darin, die Koeffizienten (Amplituden und Phasen) der einzelnen Schwingungen zu bestimmen, d. h. zu ermitteln wie ausgeprägt bestimmte Frequenzanteile auftreten.</p>
<section id="fouriereihe-in-sinus-kosinus-form">
<h4>Fouriereihe in Sinus-Kosinus-Form<a class="headerlink" href="#fouriereihe-in-sinus-kosinus-form" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[ y(t) = a_{DC} +\sum_{k=1}^{\infty}\left[a_{k}\cos\left(\frac{2\pi k}{T}t\right)+b_{k}\sin\left(\frac{2\pi k}{T}t\right)\right] \]</div>
</section>
<section id="fouriereihe-in-amplituden-phasen-form">
<h4>Fouriereihe in Amplituden-Phasen-Form<a class="headerlink" href="#fouriereihe-in-amplituden-phasen-form" title="Link to this heading">#</a></h4>
<p>Da die Sinusfunktion lediglich eine verschobene Kosinusfunktion ist, kann die obige Beziehung auch kompakter mit Amplitude <span class="math notranslate nohighlight">\(A\)</span> und Phasenverschiebung <span class="math notranslate nohighlight">\(\varphi\)</span> geschrieben werden.</p>
<div class="math notranslate nohighlight">
\[ y(t) = a_{DC} +\sum_{k=1}^{\infty}A_{k}\cos\left(\frac{2\pi k}{T}t-\varphi_{k}\right) \]</div>
<p>Dabei zeigt sich schön, worin letzlich das Ziel der Fouriertransformation besteht.</p>
<ul class="simple">
<li><p>Bestimmen der Amplituden <span class="math notranslate nohighlight">\(A\)</span> für die versch. Frequenzen im Signal <span class="math notranslate nohighlight">\(\,\to\,\)</span> <strong>Amplitudenspektrum</strong></p></li>
<li><p>Bestimmen der Phasenverschiebungen <span class="math notranslate nohighlight">\(\varphi\)</span> für die versch. Frequenzen im Signal <span class="math notranslate nohighlight">\(\,\to\,\)</span> <strong>Phasenspektrum</strong></p></li>
</ul>
<p>Amplituden- und Phasenspektrum werden zusammengenommen <strong>Frequenzspektrum</strong> genannt, wobei für uns i. Allg. nur das Amplitudenspektrum relevant ist. Die folgende Animation zeigt das Prinzip der Fourierreihe und des Frequenzspektrums sehr anschaulich.</p>
<center><img src="img/FFT.gif" width=60% /></center>
<p style="text-align: center;"><small><em>Abb.: Fouriertransformation und Frequenzbereich <a href="https://en.wikipedia.org/wiki/File:Fourier_transform_time_and_frequency_domains.gif">[Quelle]</a></em></small></p>
</section>
<section id="fouriereihe-in-exponentialform">
<h4>Fouriereihe in Exponentialform<a class="headerlink" href="#fouriereihe-in-exponentialform" title="Link to this heading">#</a></h4>
<p>Die kompakteste Form hat die Exponentialform. Mithilfe der <em>Eulerschen Formel</em> <span class="math notranslate nohighlight">\(e^{j \omega t} = \cos(\omega t) + j \cdot \sin(\omega t)\)</span> kann die Fourier-Reihe kompakt mit der komplexen Exponentialfunktion geschrieben werden. Die Koeffizienten <span class="math notranslate nohighlight">\(Y_k\)</span> stellen dabei die <em>komplexen Amplituden</em> dar und sind die gesuchten Fourierkoeffizienten.</p>
<div class="math notranslate nohighlight">
\[ y(t)=\sum_{k\in\mathbb{Z}}Y_{k} \cdot e^{j \frac{2\pi k}{T}t} \]</div>
<blockquote>
<div><p>Es ist üblich, die Fouriertransformierte eines Signals mit dem entsprechenden Grossbuchstaben des Zeitsignals zu bezeichnen. Wir bezeichnen das Zeitsignal in der Regel mit <code class="docutils literal notranslate"><span class="pre">y</span></code> und dementsprechend die Transformierte mit <code class="docutils literal notranslate"><span class="pre">Y</span></code>. Der Betrag (Amplitude) der komplexen Grösse <code class="docutils literal notranslate"><span class="pre">Y</span></code> wird mathematisch mit <span class="math notranslate nohighlight">\(|Y|\)</span> geschrieben, in Python verwenden wir als Variablenname dafür <code class="docutils literal notranslate"><span class="pre">A</span></code> (für Amplitude).</p>
</div></blockquote>
</section>
</section>
<section id="diskrete-fouriertransformation-dft">
<h3>2.2 Diskrete Fouriertransformation (DFT)<a class="headerlink" href="#diskrete-fouriertransformation-dft" title="Link to this heading">#</a></h3>
<p>Wie oben angedeutet wird ein Signal aus dem Zeitbereich mithilfe der Fouriertransformation in den Frequenzbereich (auch Bildbereich genannt) transformiert. Konkret bedeutet dies, die entsprechenden Fourierkoeffizienten zu berechnen. Wenn dies numerisch für ein zeitdiskretes (abgetastetes) Signal gemacht wird, spricht man von der <strong>diskreten Fouriertransformation</strong> (DFT). Die Fourierkoeffizienten <span class="math notranslate nohighlight">\(Y_k\)</span> sind komplex und beinhalten die Amplitudeninformationen (Betrag) und Phaseninformationen (Winkel).</p>
<div class="math notranslate nohighlight">
\[ Y_k = \sum_{n=0}^{N-1} e^{-j \frac{2\pi n}{N}k}\cdot y_n \]</div>
</section>
<section id="fft-algorithmus">
<h3>2.3 FFT-Algorithmus<a class="headerlink" href="#fft-algorithmus" title="Link to this heading">#</a></h3>
<p>Die Berechnung gemäss obiger Beziehung erfordert für lange und hochaufgelöste Zeitsignale einen erheblichen Rechenaufwand. Erst die Entwicklung des <strong>FFT-Algorithmus</strong> ermöglichte die effiziente Berechnung der diskreten Fourier-Transformation (DFT) und somit den breiten Einsatz in technischen Anwendungen.</p>
<section id="scipy-implementierung-scipy-fft">
<h4>2.3.1 SciPy-Implementierung (<code class="docutils literal notranslate"><span class="pre">scipy.fft</span></code>)<a class="headerlink" href="#scipy-implementierung-scipy-fft" title="Link to this heading">#</a></h4>
<p>SciPy stellt das Modul <strong>fft</strong> zur Verfügung, welches Funktionen zur Berechnung der Fouriertransformation enthält. Im Wesentlichen ist das die Funktion <code class="docutils literal notranslate"><span class="pre">fft()</span></code>, doch es gibt eine Reihe verwandter Funktionen, von denen wir einige verwenden werden. Die Funktion <code class="docutils literal notranslate"><span class="pre">fft()</span></code> ist für beliebige (auch komplexe) Signale definiert und liefert auch Frequenzanteile für negative Frequenzen zurück. Für reelle Zeitsignale (mit denen wir es zu tun haben), ist das Frequenzspektrum immer symmetrisch, d.h. die Frequenzanteile der negativen Frequenzen sind immer identisch mit denjenigen der positiven Frequenzen und beinhalten daher keine zusätzlichen Informationen. Wir können diese negative Frequenzachse also problemlos ignorieren (hat physikalisch keine Bedeutung). Deshalb werden wir anstelle der allgemeinen Funktion <code class="docutils literal notranslate"><span class="pre">fft()</span></code> stets die speziell für reelle Signale geeignete Funktion <code class="docutils literal notranslate"><span class="pre">rfft()</span></code> verwenden (und für die Erzeugung der Frequenzachse die Funktion <code class="docutils literal notranslate"><span class="pre">rfftfreq()</span></code>).</p>
</section>
</section>
</section>
<section id="praktische-umsetzung">
<h2>3. Praktische Umsetzung<a class="headerlink" href="#praktische-umsetzung" title="Link to this heading">#</a></h2>
<p>Die Berechnung des Frequenzspektrums (= Amplituden- und Phasenspektrums) mithilfe des FFT-Algorithmus ist dank der oben erwähnten SciPy-Implementierung sehr einfach, doch es gibt einige wichtige Aspekte, die beachtet werden müssen:</p>
<p>→ <a href=#frequency>3.1 Frequenzauflösung und max. Frequenz</a><br>
→ <a href=#windowing>3.2 Periodizität bzw. Fensterfunktionen</a><br>
→ <a href=#samples>3.3 Sampleanzahl</a><br>
→ <a href=#aliasing>3.4 Aliasing bzw. Abtasttheorem</a><br></p>
<section id="frequenzauflosung-und-maximale-frequenz">
<h3>3.1 Frequenzauflösung und maximale Frequenz<a class="headerlink" href="#frequenzauflosung-und-maximale-frequenz" title="Link to this heading">#</a></h3>
<p><a name=frequency />Die nachfolgende Abbildung zeigt ein mit 1600 Hz abgetastetes Signal, wobei es sich um eine 50 Hz-Schwingung handelt. Darunter ist das entsprechende Amplitudenspektrum dargestellt, welches erwartungsgemäss einen Peak bei 50 Hz aufweist (alle anderen Frequenzen haben keinen Anteil, da es sich beim Signal um eine reine 50 Hz-Schwingung handelt). Die Höhe des Peaks (Amplitude) entspricht der Schwingungsamplitude im Zeitsignal (<span class="math notranslate nohighlight">\(= 1\)</span>).</p>
<p><img alt="Image" src="../_images/FA_1.svg" /></p>
<p style="text-align: center;"><small><em>Abb.: Zeitsignal (oben) und Amplitudenspektrum (unten) einer 50 Hz-Schwingung</em></small></p>
<p>Anhand der obigen Abbildung können an dieser Stelle folgende Zusammenhänge erkannt werden:</p>
<ul>
<li><p>Die Frequenzauflösung <span class="math notranslate nohighlight">\(\Delta f\)</span> im Spektrum entspricht 25 Hz, was gerade dem Kehrwert der Dauer der Messung <span class="math notranslate nohighlight">\(t_{meas} =\)</span> 0.04 s entspricht. Dies ist intuitiv verständlich, denn die “langsamste” Schwingung, die in einem Zeitfenster von 0.04 s detektiert werden kann, entspricht einer 25 Hz-Schwingung. Für eine hohe Auflösung im Frequenzbereich ist also eine lange Messdauer nötig. Die Frequenzauflösung ist gleichbedeutend mit der kleinsten Frequenz <span class="math notranslate nohighlight">\(f_{min}\)</span>, welche im Spektrum angezeigt wird (abgesehen vom Gleichanteil bei 0 Hz). Da sich die Messdauer mit <span class="math notranslate nohighlight">\(t_{meas} = N \cdot 1/f_S\)</span> ausdrücken lässt, kann die Frequenzauflösung auch mit <span class="math notranslate nohighlight">\(f_S / N\)</span> berechnet werden.</p>
<div class="math notranslate nohighlight">
\[ \Delta f = f_{min} = \frac{1}{t_{meas}} = \frac{f_S}{N}\]</div>
</li>
<li><p>Die maximale Frequenz im Spektrum entspricht <span class="math notranslate nohighlight">\(f_{max} =\)</span> 800 Hz, was gerade der Hälfte der Abtastfrequenz <span class="math notranslate nohighlight">\(f_S =\)</span> 1600 Hz entspricht. Dies ist ebenfalls recht anschaulich erklärbar. Um eine Sinusschwingung überhaupt noch als Schwingung detektieren zu können, braucht es mind. 2 Abtastpunkte pro Periode, d. h. im vorliegenden Fall kann mit einer Abtastrate von 1600 Hz höchstens eine 800 Hz-Schwingung erkannt werden. Die maximale Frequenz im Spektrum <span class="math notranslate nohighlight">\(f_{max}\)</span> wird auch <em>Nyquist</em>-Frequenz genannt (vgl. <a href=#aliasing>Abtasttheorem</a>).</p>
<div class="math notranslate nohighlight">
\[ f_{max} = \frac{f_S}{2} \]</div>
</li>
</ul>
<p>Die relevanten Grössen im Frequenzbereich (<span class="math notranslate nohighlight">\(f_S\)</span>, <span class="math notranslate nohighlight">\(\Delta f\)</span>, <span class="math notranslate nohighlight">\(f_{max}\)</span>) hängen direkt mit den Grössen im Zeitbereich (<span class="math notranslate nohighlight">\(\Delta t\)</span>, <span class="math notranslate nohighlight">\(t_{meas}\)</span>) zusammen.</p>
<center>
    <img src="img/FA_1a.svg" width=100% />
</center></section>
<section id="periodizitat-bzw-fensterfunktionen">
<h3>3.2 Periodizität bzw. Fensterfunktionen<a class="headerlink" href="#periodizitat-bzw-fensterfunktionen" title="Link to this heading">#</a></h3>
<p><a name=windowing />Im obigen Beispiel entspricht die Dauer der “Messung” genau einem Vielfachen der Periodendauer der Schwingung, d. h. das Signal ist exakt periodisch im betrachteten “Fenster” (gedanklich kann der Anfang des Signals wieder ans Ende “angeschlossen” werden, ohne dass ein Sprung bzw. eine Unstetigkeit entsteht). Nachfolgend ist das gleiche Signal wie oben dargestellt, dabei wurde nun aber etwas länger gemessen (<span class="math notranslate nohighlight">\(t_{meas} =\)</span> 0.05 s), d. h. die Messzeit entspricht nicht mehr genau einem Vielfachen der Periodendauer der Schwingung.</p>
<p><img alt="Image" src="../_images/FA_2.svg" /></p>
<p style="text-align: center;"><small><em>Abb.: Messzeit entspricht nicht genau einem Vielfachen der Schwingungsperiode</em></small></p>
<p>Auffällig ist dabei folgendes:</p>
<ul class="simple">
<li><p>Obwohl es sich um die genau gleiche, reine 50 Hz-Schwingung wie in der ersten Abbildung handelt, treten nun im Spektrum auch Anteile anderer Frequenzen auf.</p></li>
</ul>
<p>Die Erklärung dafür liegt darin begründet, dass die Fouriertransformation von <strong>periodischen Signalen</strong> ausgeht und diese Voraussetzung hier offensichtlich verletzt wurde. Denkt man sich das obige Signal periodisch weiter, so resultiert das nachfolgend abgebildete Zeitsignal und es ist ersichtlich, dass nun “Sprünge” auftreten, welche das Amplitudenspektrum “verfälschen”. Die Sprünge führen zu zusätzlichen (unphysikalischen) Frequenzanteilen und “verschmieren” das Spektrum. Dieser Effekt wird auch Leck-Effekt bzw. <em>Spectral Leakage</em> genannt.</p>
<p><img alt="Image" src="../_images/FA_3.svg" /></p>
<p style="text-align: center;"><small><em>Abb.: "Gedankliche" periodische Verlängerung des Zeitsignals führt zu Sprüngen an den Übergangsstellen</em></small></p>
<p>Wie könnte dieses Problem nun behoben werden? Eine Möglichkeit, die sich in der Praxis etabliert hat, besteht darin, sogenannte <a class="reference external" href="https://de.wikipedia.org/wiki/Fensterfunktion">Fensterfunktionen</a> zu verwenden, mit denen das Zeitsignal vor der Fouriertransformation dahingehend verändert wird, dass solche Sprünge nicht oder nicht mehr so ausgeprägt auftreten. Man kann sich das so vorstellen, dass das Signal am Anfang und am Ende “langsam auf 0 runtergezogen wird”, sodass ein glatter Übergang zwischen Ende und Anfang erreicht wird bei der periodischen Wiederholung.</p>
<p>In nachfolgender Abbildung sind typische Fensterfunktionen dargestellt, wobei alle gemeinsam haben, dass sie am Anfang und am Ende gegen 0 oder einen kleinen Wert streben, womit das oben beschriebene Problem entschärft wird. Diese Fensterfunktion sind unter <code class="docutils literal notranslate"><span class="pre">signal.windows</span></code> in SciPy oder einige bekannte auch in NumPy verfügbar.</p>
<p><img alt="Image" src="../_images/FA_4.svg" /></p>
<p style="text-align: center;"><small><em>Abb.: Typische Fensterfunktionen</em></small></p>
<p>Die Anwendung der Fensterfunktion ist denkbar einfach. Das Messignal wird elementweise mit der (gleichlangen) Fensterfunktion multipliziert und geht so am Anfang und am Ende gegen 0.</p>
<blockquote>
<div><p>Der Gleichanteil (Offset) des Signals muss für die Multiplikation mit der Fensterfunktion entfernt und danach wieder hinzugefügt werden.</p>
</div></blockquote>
<p>In nachfolgender Abbildung ist nochmals das “gedanklich” periodisch wiederholte Signal dargestellt, nun wurde es aber mit der <em>Tukey</em>-Fensterfunktion konditioniert. Man erkennt, dass nun keine Sprünge zwischen den periodischen Wiederholungen auftreten, da das Signal an diesen Stellen jeweils 0 ist.</p>
<blockquote>
<div><p>Da wir in diesem Beispiel lediglich ca. 2 Perioden der Schwingung erfassen, wird das Signal durch die Fensterfunktion stark verändert. In der Praxis bzw. einem “realen” Signal ist die Messzeit im Vergleich zur Periodendauer der Schwingung(en) in der Regel sehr gross und dieser Effekt daher vernachlässigbar.</p>
</div></blockquote>
<p><img alt="Image" src="../_images/FA_5.svg" /></p>
<p style="text-align: center;"><small><em>Abb.: Periodische Verlängerung des Zeitsignals mit Fensterung, d.h. es treten keine Sprünge mehr auf</em></small></p>
<p>Betrachten wir nun das Amplitudenspektrum des mit der Fensterfunktion vorkonditionierten Signals verschwinden die unphysikalischen hohen Frequenzen weitgehend aus dem Spektrum (vgl. Anmerkung oben).</p>
<p><img alt="Image" src="../_images/FA_6.svg" /></p>
<p style="text-align: center;"><small><em>Abb.: Amplitudenspektrum mit/ohne Fensterfunktion</em></small></p></section>
<section id="sampleanzahl">
<h3>3.3 Sampleanzahl<a class="headerlink" href="#sampleanzahl" title="Link to this heading">#</a></h3>
<p><a name=samples />Die Berechnung des Frequenzspektrums ist für lange Messungen, welche mit einer hohen Abtastfrequenz abgetastet wurden (also aus sehr vielen Samples bestehen), sehr aufwändig und der FFT-Algorithmus nutzt spezielle Eigenschaften (Symmetrien etc.) des Frequenzsprektrums aus um die Berechnung möglichst effizient zu machen. Am effizientesten ist der Algorithmus, wenn die Sampleanzahl <span class="math notranslate nohighlight">\(N\)</span> einer 2er-Potenz entspricht (also z. B. <span class="math notranslate nohighlight">\(2^{16}\)</span> usw.). Da Messungen in der Praxis in der Regel nicht genau eine solche Anzahl Samples aufweisen, gibt es versch. Möglichkeiten:</p>
<ul class="simple">
<li><p>Die meisten mordernen FFT-Implementierungen (z. B. SciPy, NumPy, etc.) können relativ problemlos mit einer “unpassenden” Sampleanzahl umgehen. Allenfalls dauert die Berechnung etwas länger, doch das ist bei Berechnungen auf einem modernen Computer etc. meistens nicht problematisch. Bei Realtime-Berechnungen auf leistungsschwachen Geräten (Microcontrollern etc.) wird die Sampleanzahl allerdings idealerweise günstig gewählt.</p></li>
<li><p>Die FFT-Funktion in SciPy hat einen zweiten Parameter (<code class="docutils literal notranslate"><span class="pre">n</span></code>), mit dem man steuern kann, wieviele Samples für die FFT-Berechnung verwendet werden. Ist <code class="docutils literal notranslate"><span class="pre">n</span></code> kleiner als die Samplanzahl des Signals, so werden nur <code class="docutils literal notranslate"><span class="pre">n</span></code> Samples verwendet und die übrigen ignoriert (<em>Cropping</em>). Ist <code class="docutils literal notranslate"><span class="pre">n</span></code> grösser als die Sampleanzahl des Signals, so wird das Signal mit 0 aufgefüllt (<em>Zero Padding</em>). Dies hat einen geringfügigen Einfluss auf das Spektrum, doch dieser ist in vielen praktischen Anwendungen unerheblich. Nachfolgend ist das Spektrum einer verrauschten Sinusschwingung dargestellt, wobei einmal die ursprüngliche (ungünstige) Sampleanzahl <span class="math notranslate nohighlight">\(N\)</span> und dann die nächstkleinere bzw. nächstgrössere 2er-Potenz als Sampleanzahl verwendet wurde. Darunter sind die Rechenzeiten der FFT angegeben und man erkennt, dass die ungünstige Sampleanzahl eine 5..10 x längere Rechenzeit aufweist. (Für uns ist dies jedoch im Allgemeinen unerheblich, d. h. wir werden üblicherweise die effektive Sampleanzahl der Messung verwenden.)</p></li>
</ul>
<p><img alt="Image" src="../_images/FA_7.svg" /></p>
<p style="text-align: center;"><small><em>Abb.: Einfluss der verwendeten Sampleanzahl auf das Amplitudenspektrum</em></small></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Sampleanzahl <span class="math notranslate nohighlight">\(N\)</span></p></th>
<th class="head"><p>Zeitbedarf FFT [ms]</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>3839573</p></td>
<td><p>1131</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(2^{21}\)</span> = 2097152 (Cropping)</p></td>
<td><p>98</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(2^{22}\)</span> = 4194304 (Padding)</p></td>
<td><p>293</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Eine weitere Möglichkeit besteht darin, dass Signal zu “resamplen”, d. h. das Signal an andern Stützstellen abzutasten, um so eine günstige Sampleanzahl zu erreichen. Dies kann sehr einfach z. B. mittels Interpolation (vgl. <code class="docutils literal notranslate"><span class="pre">interp()</span></code> aus NumPy) erfolgen.</p></li>
</ul>
<p><img alt="Image" src="../_images/FA_8.svg" /></p>
<p style="text-align: center;"><small><em>Abb.: Interpoliertes Zeitsignal, um eine günstige Sampleanzahl zu erreichen</em></small></p>
</section>
<section id="abtasttheorem">
<h3>3.4 Abtasttheorem<a class="headerlink" href="#abtasttheorem" title="Link to this heading">#</a></h3>
<p><a name=aliasing />Wir haben oben gesehen, dass die maximale Frequenz <span class="math notranslate nohighlight">\(f_{max}\)</span> im Spektrum der halben Abtastfrequenz <span class="math notranslate nohighlight">\(f_S\)</span> entspricht. Dies bedeutet, dass Schwingungen bis zu dieser Frequenz vollständig aus dem abgetasteten Signal rekonstruiert werden können. Dies ist ein grundlegendes Theorem der Informationstheorie und wird <em>Nyquist-Shannon-Abtasttheorem</em> (oder kurz einfach <strong>Abtasttheorem</strong>) genannt. <em>Es besagt, dass ein Signal mit einer Abtastfrequenz abgetastet werden muss, die mindestens doppelt so gross ist wie die höchste im Signal auftretende Frequenz</em>.</p>
<div class="math notranslate nohighlight">
\[ f_S &gt; 2 \cdot f_{Signal_{max}} \]</div>
<p>Die Verletzung des Abtasttheorems kann zu einer kompletten Verfälschung des Spektrums führen, da “scheinbare” Frequenzanteile erzeugt werden, die aber nicht im Signal enthalten sind. An einem Beispiel soll gezeigt werden, was passiert, wenn ein Signal mit einer zu geringen Abtastfrequenz abgetastet wird. In nachfolgender Abbildung wird eine 25 Hz-Schwingung (blau) mit einer zu kleinen Abtastfrequenz von <span class="math notranslate nohighlight">\(f_S =\)</span> 30 Hz erfasst, womit das Abtasttheorem verletzt wird (30 Hz <span class="math notranslate nohighlight">\(\ngtr\)</span> 2 <span class="math notranslate nohighlight">\(\cdot\)</span> 25 Hz). Wird vom erfassten Signal nun das Frequenzspektrum erstellt, erscheint dort ein Peak bei 5 Hz, obwohl im Signal weit und breit keine 5 Hz-Schwingung vorhanden ist. Zum Vergleich ist zusätzlich der korrekte Peak bei 25 Hz eingetragen (blau), der mit korrekter Abtastung erkannt worden wäre. Dieses Phänomen wird als <em>Aliasing</em> bezeichnet und betrifft sämtliche Abtastvorgänge.</p>
<p><img alt="Image" src="../_images/FA_9.svg" /></p>
<p style="text-align: center;"><small><em>Abb.: Abtastung mit zu kleiner Abtastfrequenz (rote Kurve) führt zu unphysikalischen Frequenzanteilen (Aliasing)</em></small></p>
<blockquote>
<div><p>Man muss sich im Klaren sein, dass im obigen Diagramm für Vergleichszwecke das “korrekte” Signal in blau eingetragen ist. Dieses würde man bei einer realen Messung mit der zu tiefen Abtastfrequenz aber eben genau nicht erkennen, sondern nur das rote (“falsche”) Signal und es gäbe im Nachhinein keine Möglichkeit, dieses Problem zu erkennen bzw. zu korrigieren. Die Einhaltung des Abtasttheorems ist daher extrem wichtig!</p>
</div></blockquote>
<p>Zum Beispiel tritt dieses Phänomen häufig in Videos auf, wenn eine Bewegung gefilmt wird, die “schneller” ist, als es die Abtastung (zeitliche Auflösung) erfassen kann. Die Bewegung scheint dann z. T. viel zu langsam oder sogar in die “verkehrte” Richtung abzulaufen (“Rad dreht rückwärts” etc.). Es scheint dann eine “Frequenz” zu geben, die in Wirklichkeit natürlich nicht vorkommt.</p>
<center>
    <video controls src="img/Aliasing.mp4" width='100%' />
</center>
<p style="text-align: center;"><small><em>Abb.: Aliasing-Effekt in Video <a href="https://www.youtube.com/watch?v=ByTsISFXUoY&ab_channel=FABIOGERMANGUERREROMORENO">[Quelle]</a></em></small></p>
<hr class="docutils" />
<p style='text-align: right; font-size: 70%;'>Angewandte Mathematik | MAT_AGW | 2024</p></section>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./06_FFT"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../05_SCIPY/11_SCIPY_Uebungen.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Übungen</p>
      </div>
    </a>
    <a class="right-next"
       href="02_FFT_Unterricht.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Unterrichtsbeispiel</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#blockinhalt">Blockinhalt</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#voraussetzungen">Voraussetzungen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">1. Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grundlagen">2. Grundlagen</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fourierreihe">2.1 Fourierreihe</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fouriereihe-in-sinus-kosinus-form">Fouriereihe in Sinus-Kosinus-Form</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fouriereihe-in-amplituden-phasen-form">Fouriereihe in Amplituden-Phasen-Form</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fouriereihe-in-exponentialform">Fouriereihe in Exponentialform</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diskrete-fouriertransformation-dft">2.2 Diskrete Fouriertransformation (DFT)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fft-algorithmus">2.3 FFT-Algorithmus</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy-implementierung-scipy-fft">2.3.1 SciPy-Implementierung (<code class="docutils literal notranslate"><span class="pre">scipy.fft</span></code>)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#praktische-umsetzung">3. Praktische Umsetzung</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequenzauflosung-und-maximale-frequenz">3.1 Frequenzauflösung und maximale Frequenz</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#periodizitat-bzw-fensterfunktionen">3.2 Periodizität bzw. Fensterfunktionen</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sampleanzahl">3.3 Sampleanzahl</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtasttheorem">3.4 Abtasttheorem</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By S. Krauss
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>